# Mai-Soul-Engine - 配置模板
# 使用方式：
# 1) 复制本文件为 config.toml
# 2) 按需修改配置
# 3) config.toml 已加入 .gitignore（不要提交包含你私人信息的配置）

# 管理员配置
[admin]

# 管理员用户ID（必填，格式：平台:ID，如 qq:768295235）
admin_user_id = ""

# 启用插件
enabled = true


# 演化设置
[evolution]

# 启用自动演化
evolution_enabled = true

# 演化周期(小时)
evolution_interval_hours = 1.0

# 每次演化最大变化值
evolution_rate = 5

# EMA平滑系数(0-1，越大变化越快)
ema_alpha = 0.3

# 反向变动阻力(0-1，越大阻力越强)
direction_resistance = 0.5

# 每次分析的最大消息数
max_messages_per_analysis = 200

# 每条消息的最大字符数
max_chars_per_message = 200


# 监控范围（演化仅针对监控群）
[monitor]

# 监控的群ID列表(空=不分析任何群)，格式：平台:群号:group（或直接填stream_id）
monitored_groups = []

# 排除的群ID列表，格式：平台:群号:group（或直接填stream_id）
excluded_groups = []

# 监控的用户ID列表(空=全部)，格式：平台:ID
monitored_users = []

# 排除的用户ID列表，格式：平台:ID
excluded_users = []


# 档位阈值
[threshold]

# 启用极端档位(98-100触发)
enable_extreme = false

# 自定义提示词模板(覆盖默认)
custom_prompts = { }


# 注入设置
[injection]

# 群聊注入范围：global=所有群，monitored_only=仅 monitored_groups（仍受 excluded_groups 影响）
scope = "global"

# 是否允许私聊注入（默认开启）
inject_private = true

# 每次注入最多携带的 trait 数量
max_traits = 3

# 当无 tags 命中时，是否 fallback 注入“最近影响最大”的 traits（避免完全空窗）
fallback_recent_impact = true

# trait 冷却时间（秒）。冷却期间同一 trait 不会被重复注入（避免刷屏）
trait_cooldown_seconds = 180


# 思维阁设置
[thought_cabinet]

# 启用思维阁系统（默认关闭）
enabled = false

# 思维种子上限
max_seeds = 20

# 最小触发强度
min_trigger_intensity = 0.7

# 启用管理员审核通知
admin_notification_enabled = true

# 自动合并相似 trait（去重，避免同义 trait 越积越多）
auto_dedup_enabled = true

# 自动去重阈值（0-1，越高越严格）
auto_dedup_threshold = 0.78


# API 设置
[api]

# 启用 Soul HTTP API（/api/v1/soul/*）
enabled = true

# 访问令牌（可选）。前端请求头：X-Soul-Token；也可用环境变量 SOUL_API_TOKEN 覆盖
token = ""

# 公共展示模式：对外展示时减少/脱敏敏感字段（targets、evidence、注入细节等）
public_mode = false
